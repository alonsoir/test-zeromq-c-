git add -A
git commit -m "üéØ Day 37: ADR-002 Multi-Engine Provenance + ADR-001 Encrypted Artifacts

MAJOR MILESTONE: Complete implementation of situational intelligence system

## ADR-002: Multi-Engine Detection Provenance ‚úÖ
- Extended protobuf contract with DetectionProvenance message
- Added 5 reason codes (Gemini table): SIG_MATCH, STAT_ANOMALY, PCA_OUTLIER, PROT_VIOLATION, ENGINE_CONFLICT
- Sniffer now fills EngineVerdict with fast-path detection context
- ml-detector adds RandomForest verdict + calculates discrepancy_score
- rag-ingester parses complete provenance (verdicts + metadata)
- Event struct extended with std::vector<EngineVerdict> + discrepancy_score

## ADR-001: Encrypted RAG Artifacts (BONUS) ‚úÖ
- RAGLogger now encrypts .pb and .json artifacts (.pb.enc, .json.enc)
- Pipeline: Serialize ‚Üí Compress (LZ4) ‚Üí Encrypt (ChaCha20-Poly1305)
- Prevents log poisoning attacks (no config bypass for security)
- crypto_manager correctly passed through component chain

## Infrastructure Updates ‚úÖ
- Vagrantfile: Permanent fix for ONNX Runtime lib64 symlinks
- Created /vagrant/common/include/ for shared headers (reason_codes.hpp)
- Updated CMakeLists.txt for sniffer, ml-detector, rag-ingester
- All components compile cleanly and produce functional binaries

## Technical Debt Identified üìã
- ISSUE-007: Magic numbers in ml-detector (0.30, 0.70) ‚Üí Move to JSON config
- ISSUE-005: RAGLogger memory leak (nlohmann/json) ‚Üí RapidJSON migration
- ISSUE-003: Thread-local FlowManager bug ‚Üí 11/102 features only
- MISSING: Acceptance tests for protobuf contract
- MISSING: Log file persistence (stdout only, should write to files)

## Architecture Impact üèõÔ∏è
This transforms the system from binary classification to **situational intelligence**:
- Not just \"what\" but \"why\" and \"how confident\"
- Enables 0-day detection via PCA_OUTLIER + ENGINE_CONFLICT signals
- Supports adaptive learning (LLM understands campus-specific patterns)
- Complete audit trail for forensics and vaccine generation
- Foundation for GAIA hierarchical immune system

## Next Steps (Day 38) üéØ
1. Verify clean compilation from scratch (VM rebuild test)
2. Generate synthetic .pb.enc files with provenance for testing
3. Update ONNX Embedders to process 103 features (101 + 2 meta)
4. Acceptance tests for protobuf contract end-to-end
5. Prepare fixes for identified technical debt

## Files Changed
Modified:
  - /vagrant/protobuf/network_security.proto (DetectionProvenance)
  - /vagrant/common/include/reason_codes.hpp (NEW)
  - /vagrant/sniffer/src/userspace/ring_consumer.cpp (verdict filling)
  - /vagrant/sniffer/CMakeLists.txt (common include)
  - /vagrant/ml-detector/src/zmq_handler.cpp (provenance + crypto)
  - /vagrant/ml-detector/include/rag_logger.hpp (crypto_manager)
  - /vagrant/ml-detector/src/rag_logger.cpp (encrypted artifacts)
  - /vagrant/ml-detector/CMakeLists.txt (common include)
  - /vagrant/rag-ingester/include/event_loader.hpp (EngineVerdict struct)
  - /vagrant/rag-ingester/src/event_loader.cpp (provenance parsing)
  - /vagrant/rag-ingester/CMakeLists.txt (common include)
  - Vagrantfile (ONNX Runtime lib64 symlinks)

Compiled Successfully:
  - sniffer: 1.4M binary
  - ml-detector: [100%] Built target ml-detector
  - rag-ingester: [100%] Built target rag-ingester

Co-authors: Alonso Martinez-Alonso, Claude (Anthropic), Gemini (Google)
Via Appia Quality: Foundation for 2000-year architecture ‚úÖ
Security: ADR-001 + ADR-002 enforced at code level, not config level üîí"