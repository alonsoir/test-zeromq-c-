git checkout -b feature/build-system-single-source-of-truth

git add Makefile \
        ml-detector/CMakeLists.txt \
        sniffer/CMakeLists.txt \
        rag-ingester/CMakeLists.txt \
        common-rag-ingester/CMakeLists.txt \
        firewall-acl-agent/CMakeLists.txt \
        etcd-server/CMakeLists.txt \
        tools/CMakeLists.txt \
        crypto-transport/CMakeLists.txt \
        etcd-client/CMakeLists.txt

git commit -m "refactor(build): Establish root Makefile as Single Source of Truth

PROBLEM:
- Hardcoded compiler flags in 9 CMakeLists.txt files
- Conflicts between component flags and root Makefile
- Inconsistent build configurations across profiles
- Docker/docker-compose references (obsolete)

SOLUTION:
- Remove ALL hardcoded -O, -g, -fsanitize flags from CMakeLists.txt
- Implement profile system in root Makefile (production/debug/tsan/asan)
- Add profile-specific build directories (build-PROFILE/)
- Fix protobuf distribution for profile-aware builds
- Eliminate Docker/docker-compose references

VALIDATION:
- Production: 1.4M (91% size reduction via -O3 -flto)
- Debug: 17M (full symbols, -g -O0)
- TSAN: 23M (ThreadSanitizer v2 active, validated)
- ASAN: AddressSanitizer active (validated)
- Linkage: etcd_client + crypto_transport correct in all profiles

COMPONENTS REFACTORED:
- sniffer, ml-detector, rag-ingester, firewall-acl-agent
- etcd-server, tools, crypto-transport, etcd-client
- common-rag-ingester

FILES MODIFIED: 10 (1 Makefile + 9 CMakeLists.txt)

Via Appia Quality:
- Evidence-based validation (measured binary sizes)
- Systematic refactoring (identical pattern across 9 files)
- Build system foundation solidified

Tested: macOS â†’ Vagrant â†’ Ubuntu 22.04
Co-authored-by: Claude (Anthropic AI)"
```

---

## ðŸ“Š ESTADO DEL PROYECTO

### **Build System:**
```
Single Source of Truth:    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
Profile System:             â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
CMakeLists.txt Cleanup:     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
Validation Tests:           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
Documentation:              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  40% ðŸŸ¡
```

### **ML Defender Pipeline:**
```
Foundation (ISSUE-003):     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
Thread-Safety (TSAN):       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
Contract Validation:        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…
Build System Refactoring:   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100% âœ…