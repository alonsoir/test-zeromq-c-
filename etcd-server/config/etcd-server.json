{
  "server": {
    "port": 2379,
    "host": "0.0.0.0",
    "worker_threads": 4
  },
  "heartbeat": {
    "enabled": true,
    "interval_seconds": 30,
    "timeout_multiplier": 3,
    "check_interval_seconds": 10
  },
  "auto_restart": {
    "enabled": true,
    "max_attempts": 3,
    "delay_seconds": 5,
    "commands": {
      "sniffer": "cd /vagrant/sniffer/build && sudo ./sniffer -c ../config/sniffer.json",
      "ml-detector": "cd /vagrant/ml-detector/build && ./ml-detector -c ../config/ml_detector_config.json",
      "firewall-acl-agent": "cd /vagrant/firewall-acl-agent/build && sudo ./firewall-acl-agent -c ../config/firewall.json"
    }
  },
  "security": {
    "encryption_enabled": true,
    "compression_enabled": true
  },
  "secrets": {
    "_comment": "Day 53: HMAC secrets management for log integrity",
    "enabled": true,
    "default_key_length_bytes": 32,
    "rotation_interval_hours": 168,
    "auto_generate_on_startup": true,
    "storage": {
      "_comment": "Future: Persistent storage path for secrets (not implemented yet)",
      "path": "/var/lib/etcd-server/secrets",
      "encryption": "aes-256-gcm"
    },
    "keys": {
      "_comment": "Default keys auto-generated on startup",
      "rag_log_hmac": {
        "path": "/secrets/rag/log_hmac_key",
        "algorithm": "hmac-sha256",
        "purpose": "HMAC validation for RAG log files",
        "rotation_enabled": true
      },
      "ml_detector_hmac": {
        "_comment": "Future: HMAC for ml-detector outputs",
        "path": "/secrets/ml-detector/log_hmac_key",
        "algorithm": "hmac-sha256",
        "purpose": "HMAC validation for ML detector event logs",
        "rotation_enabled": true,
        "auto_generate": false
      },
      "firewall_hmac": {
        "_comment": "Future: HMAC for firewall logs",
        "path": "/secrets/firewall/log_hmac_key",
        "algorithm": "hmac-sha256",
        "purpose": "HMAC validation for firewall ACL agent logs",
        "rotation_enabled": true,
        "auto_generate": false
      }
    }
  }
}