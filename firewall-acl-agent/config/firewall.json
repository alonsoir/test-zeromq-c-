{
  "_comment": "ML Defender - Firewall ACL Agent Configuration",
  "_version": "1.0.0",
  "_updated": "2025-11-22 - Cleaned and validated against C++ structs",

  "ipset": {
    "set_name": "ml_defender_blacklist",
    "set_type": "hash:ip",
    "hash_size": 4096,
    "max_elements": 1000000,
    "timeout": 3600,
    "comment": "ML Defender blocked IPs"
  },

  "iptables": {
    "chain_name": "ML_DEFENDER_INPUT",
    "default_policy": "ACCEPT",
    "log_blocked": false,
    "log_prefix": "ML_DEFENDER_DROP: ",
    "enable_rate_limiting": true,
    "rate_limit_connections": 100
  },

  "batch_processor": {
    "batch_size_threshold": 1000,
    "batch_time_threshold_ms": 100,
    "max_pending_ips": 10000,
    "min_confidence": 0.5
  },

  "zmq": {
    "endpoint": "tcp://localhost:5572",
    "topic": "",
    "recv_timeout_ms": 1000,
    "linger_ms": 1000,
    "reconnect_interval_ms": 1000,
    "max_reconnect_interval_ms": 30000,
    "enable_reconnect": true
  },

  "daemon": {
    "daemonize": false,
    "pid_file": "/var/run/firewall-acl-agent.pid",
    "user": "root",
    "group": "root"
  },

  "logging": {
    "level": "info",
    "console": true,
    "syslog": false,
    "file": "",
    "max_file_size_mb": 100
  },

  "metrics": {
    "enable_export": true,
    "export_interval_sec": 60,
    "export_format": "json",
    "export_file": "/var/log/ml-defender/firewall-metrics.json"
  },

  "health_check": {
    "enable": true,
    "check_interval_sec": 30,
    "ipset_health_check": true,
    "iptables_health_check": true,
    "zmq_connection_check": true
  }
}
