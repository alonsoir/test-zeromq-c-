{
  "_header": "C++20 ML DETECTOR TRICAPA v1.0 - Production Config (REFACTORED)",
  "_refactor_notes": {
    "date": "2025-11-15",
    "changes": [
      "\u2728 UPDATED: Level 2 DDoS changed from ONNX to Embedded C++20",
      "\u2728 UPDATED: Level 2 Ransomware enabled (Embedded C++20)",
      "\u2728 UPDATED: Level 3 Web enabled for Traffic classification (Embedded C++20)",
      "\u2728 UPDATED: Level 3 Internal already configured, just enabled (Embedded C++20)"
    ]
  },
  "component": {
    "name": "cpp_ml_detector_tricapa",
    "version": "1.0.0",
    "mode": "ml_inference_tricapa",
    "onnx_runtime_version": "1.16.0"
  },
  "node_id": "cpp_ml_detector_v1_001",
  "cluster_name": "upgraded-happiness-cluster",
  "profiles": {
    "lab": {
      "worker_threads": 2,
      "input_queue_size": 300,
      "output_queue_size": 200,
      "compression_level": 1,
      "enable_all_models": true
    },
    "cloud": {
      "worker_threads": 8,
      "input_queue_size": 1000,
      "output_queue_size": 500,
      "compression_level": 3,
      "enable_all_models": true
    },
    "bare_metal": {
      "worker_threads": 16,
      "input_queue_size": 2000,
      "output_queue_size": 1000,
      "compression_level": 1,
      "enable_all_models": true,
      "cpu_affinity_enabled": true
    }
  },
  "profile": "lab",
  "network": {
    "input_socket": {
      "endpoint": "tcp://127.0.0.1:5571",
      "mode": "connect",
      "socket_type": "PULL",
      "high_water_mark": 1000
    },
    "output_socket": {
      "endpoint": "tcp://0.0.0.0:5572",
      "mode": "bind",
      "socket_type": "PUB",
      "high_water_mark": 1000
    }
  },
  "zmq": {
    "worker_threads": 2,
    "io_thread_pools": 1,
    "connection_settings": {
      "sndhwm": 1000,
      "rcvhwm": 1000,
      "linger_ms": 100,
      "send_timeout_ms": 250,
      "recv_timeout_ms": 500,
      "sndbuf": 262144,
      "rcvbuf": 262144,
      "immediate": 0
    },
    "queue_management": {
      "input_queue_size": 300,
      "output_queue_size": 200,
      "queue_timeout_ms": 100,
      "overflow_policy": "drop_oldest"
    }
  },
  "transport": {
    "compression": {
      "enabled": false,
      "algorithm": "lz4",
      "level": 1,
      "min_compress_size": 0,
      "compression_ratio_threshold": 0.8,
      "adaptive_compression": false
    },
    "encryption": {
      "enabled": false,
      "etcd_token_required": false,
      "algorithm": "chacha20-poly1305",
      "key_size": 256,
      "key_rotation_hours": 24,
      "fallback_mode": "compression_only"
    }
  },
  "etcd": {
    "enabled": true,
    "endpoints": [
      "localhost:2379"
    ],
    "connection_timeout_ms": 5000,
    "retry_attempts": 3,
    "retry_interval_ms": 1000,
    "crypto_token_path": "/crypto/ml-detector/tokens",
    "config_sync_path": "/config/ml-detector",
    "service_registration_path": "/services/ml-detector",
    "required_for_encryption": false,
    "fallback_mode": "standalone_compression_only",
    "heartbeat_interval_seconds": 30,
    "lease_ttl_seconds": 60
  },
  "threading": {
    "worker_threads": 2,
    "protobuf_deserializer_threads": 1,
    "feature_extractor_threads": 1,
    "ml_inference_threads": 2,
    "zmq_sender_threads": 1,
    "total_worker_threads": 7,
    "cpu_affinity": {
      "enabled": false,
      "deserializers": [
        0
      ],
      "feature_extractors": [
        1,
        2
      ],
      "ml_inference": [
        3,
        4,
        5
      ],
      "zmq_senders": [
        6
      ]
    },
    "thread_priorities": {
      "deserializers": "high",
      "feature_extractors": "normal",
      "ml_inference": "high",
      "zmq_senders": "normal"
    }
  },
  "ml": {
    "models_base_dir": "models/production",
    "thresholds": {
      "level1_attack": 0.65,
      "level2_ddos": 0.7,
      "level2_ransomware": 0.75,
      "level3_anomaly": 0.8,
      "level3_web": 0.6,
      "level3_internal": 0.65
    },
    "level1": {
      "enabled": true,
      "name": "attack_detector",
      "model_file": "level1/level1_attack_detector.onnx",
      "scaler_file": "level1/scaler.json",
      "features_count": 23,
      "model_type": "RandomForest",
      "description": "General attack detection - Random Forest (23 features)",
      "requires_scaling": true,
      "timeout_ms": 10
    },
    "level2": {
      "ddos": {
        "enabled": true,
        "name": "ddos_binary_detector",
        "model_file": "",
        "features_count": 10,
        "model_type": "RandomForest-Embedded",
        "description": "\u2728 DDoS Detection - Embedded C++20 RandomForest (100 trees, 612 nodes, <50\u03bcs latency)",
        "requires_scaling": false,
        "timeout_ms": 1,
        "implementation": "native_cpp",
        "features": [
          "syn_ack_ratio",
          "packet_symmetry",
          "source_ip_dispersion",
          "protocol_anomaly_score",
          "packet_size_entropy",
          "traffic_amplification_factor",
          "flow_completion_rate",
          "geographical_concentration",
          "traffic_escalation_rate",
          "resource_saturation_score"
        ]
      },
      "ransomware": {
        "enabled": true,
        "name": "ransomware_detector_embedded",
        "model_file": "",
        "features_count": 10,
        "model_type": "RandomForest-Embedded",
        "description": "\u2728 Ransomware Detection - Embedded C++20 RandomForest (100 trees, 3764 nodes, <55\u03bcs latency)",
        "requires_scaling": false,
        "timeout_ms": 1,
        "threshold": 0.75,
        "implementation": "native_cpp",
        "features": [
          "io_intensity",
          "entropy",
          "resource_usage",
          "network_activity",
          "file_operations",
          "process_anomaly",
          "temporal_pattern",
          "access_frequency",
          "data_volume",
          "behavior_consistency"
        ]
      }
    },
    "level3": {
      "web": {
        "enabled": true,
        "name": "traffic_detector_embedded",
        "model_file": "",
        "features_count": 10,
        "model_type": "RandomForest-Embedded",
        "description": "\u2728 Traffic Classification (Internet vs Internal) - Embedded C++20 RandomForest (100 trees, 1014 nodes, <50\u03bcs latency)",
        "requires_scaling": false,
        "timeout_ms": 1,
        "implementation": "native_cpp",
        "features": [
          "packet_rate",
          "connection_rate",
          "tcp_udp_ratio",
          "avg_packet_size",
          "port_entropy",
          "flow_duration_std",
          "src_ip_entropy",
          "dst_ip_concentration",
          "protocol_variety",
          "temporal_consistency"
        ]
      },
      "internal": {
        "enabled": true,
        "name": "internal_detector_embedded",
        "model_file": "",
        "features_count": 10,
        "model_type": "RandomForest-Embedded",
        "description": "\u2728 Internal Traffic Analysis - Embedded C++20 RandomForest (100 trees, 940 nodes, <48\u03bcs latency) - Lateral Movement & Data Exfiltration",
        "requires_scaling": false,
        "timeout_ms": 1,
        "implementation": "native_cpp",
        "features": [
          "internal_connection_rate",
          "service_port_consistency",
          "protocol_regularity",
          "packet_size_consistency",
          "connection_duration_std",
          "lateral_movement_score",
          "service_discovery_patterns",
          "data_exfiltration_indicators",
          "temporal_anomaly_score",
          "access_pattern_entropy"
        ]
      }
    },
    "inference": {
      "batch_size": 32,
      "enable_model_warmup": true,
      "warmup_iterations": 10,
      "onnx_optimization_level": "all",
      "inter_op_threads": 4,
      "intra_op_threads": 4,
      "enable_cpu_mem_arena": true,
      "enable_profiling": false
    },
    "feature_extraction": {
      "validate_features": true,
      "pad_missing": true,
      "log_extraction_errors": true,
      "cache_extractions": false,
      "cache_size": 1000,
      "simd_optimization": true
    },
    "degraded_mode": {
      "min_models_required": 1,
      "continue_with_partial_models": true,
      "fallback_to_heuristics": true,
      "log_degraded_operations": true
    }
  },
  "inference": {
    "batch_size": 1,
    "enable_model_warmup": true,
    "warmup_iterations": 3,
    "onnx_optimization_level": "all",
    "inter_op_threads": 2,
    "intra_op_threads": 2,
    "enable_cpu_mem_arena": true,
    "enable_profiling": false
  },
  "feature_extraction": {
    "validate_features": true,
    "pad_missing": true,
    "log_extraction_errors": false,
    "cache_extractions": true,
    "cache_size": 500,
    "simd_optimization": true
  },
  "degraded_mode": {
    "min_models_required": 1,
    "continue_with_partial_models": true,
    "fallback_to_heuristics": true,
    "log_degraded_operations": true
  },
  "processing": {
    "input_queue_size": 300,
    "output_queue_size": 200,
    "queue_timeout_ms": 100,
    "batch_processing": {
      "enabled": false,
      "batch_size": 1,
      "batch_timeout_ms": 10
    },
    "lockfree_queues": true,
    "numa_aware_allocation": false,
    "memory_prefaulting": false
  },
  "backpressure": {
    "enabled": true,
    "activation_threshold": 0.7,
    "max_drops_per_second": 1000,
    "adaptive_rate_limiting": true,
    "circuit_breaker": {
      "enabled": true,
      "failure_threshold": 50,
      "recovery_timeout_seconds": 30
    }
  },
  "monitoring": {
    "stats_interval_seconds": 60,
    "performance_tracking": true,
    "ml_metrics": {
      "inference_time": true,
      "model_accuracy": false,
      "feature_importance": false,
      "predictions_per_second": true,
      "model_load_time": true
    },
    "system_metrics": {
      "queue_depth": true,
      "memory_usage": true,
      "thread_utilization": true,
      "compression_ratio": true,
      "zmq_throughput": true
    },
    "alerts": {
      "max_inference_latency_ms": 10,
      "max_queue_usage_percent": 85,
      "max_memory_usage_mb": 1024,
      "max_cpu_usage_percent": 80,
      "min_compression_ratio": 0.3,
      "max_model_failures_per_minute": 10
    }
  },
  "logging": {
    "level": "INFO",
    "file": "logs/cpp_ml_detector_tricapa_v1.log",
    "max_file_size_mb": 200,
    "backup_count": 10,
    "include_performance_logs": true,
    "include_compression_stats": true,
    "include_thread_stats": true,
    "include_ml_predictions": true,
    "log_inference_scores": true,
    "log_feature_extraction": false
  },
  "protobuf": {
    "schema_version": "v3.1.0",
    "validate_before_processing": true,
    "validate_after_enrichment": true,
    "max_event_size_bytes": 100000,
    "deserialization_timeout_ms": 50,
    "serialization_timeout_ms": 50,
    "pool_size": 1000,
    "reuse_objects": true
  },
  "security": {
    "input_validation": {
      "enabled": true,
      "validate_protobuf_schema": true,
      "sanitize_features": true,
      "reject_malformed_events": true,
      "max_feature_value": 1000000000,
      "min_features_required": 10
    }
  },
  "performance": {
    "enable_zero_copy": true,
    "enable_memory_pools": true,
    "preallocate_buffers": true,
    "buffer_pool_size": 1000,
    "enable_simd": true,
    "enable_avx2": true,
    "cache_line_size": 64
  }
}