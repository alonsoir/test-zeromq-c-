# ddos_template.txt
///   [1] packet_symmetry
///   [2] source_ip_dispersion
///   [3] protocol_anomaly_score
///   [4] packet_size_entropy
///   [5] traffic_amplification_factor
///   [6] flow_completion_rate
///   [7] geographical_concentration
///   [8] traffic_escalation_rate
///   [9] resource_saturation_score
/// @return Probability of DDoS attack (0.0 to 1.0)
inline float predict_ddos(const float features[DDOS_NUM_FEATURES]) {
    float normal_prob = 0.0f;
    float ddos_prob = 0.0f;
    
    for (size_t tree_idx = 0; tree_idx < DDOS_NUM_TREES; ++tree_idx) {
        const DDoSTreeNode* tree = ddos_trees[tree_idx];
        size_t node_idx = 0;
        
        while (true) {
            const auto& node = tree[node_idx];
            
            if (node.feature_idx == -2) { // Leaf node
                normal_prob += node.value[0];
                ddos_prob += node.value[1];
                break;
            }
            
            if (features[node.feature_idx] <= node.threshold) {
                node_idx = node.left_child;
            } else {
                node_idx = node.right_child;
            }
        }
    }
    
    // Return probability of DDoS (class 1)
    return ddos_prob / DDOS_NUM_TREES;
}

} // namespace ml_defender::ddos
