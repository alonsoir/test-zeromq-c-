{
  "model_name": "level2_ddos_binary_detector",
  "level": 2,
  "purpose": "Binary DDoS Detection (BENIGN vs DDOS)",
  "version": "1.0.0",
  "created_date": "2025-10-22",
  
  "feature_mapping": {
    "description": "Mapeo entre NetworkFeatures (protobuf) y features del modelo ML",
    "total_features_in_protobuf": 83,
    "features_used_in_model": 70,
    "excluded_features": [
      "source_ip (string - no numeric)",
      "destination_ip (string - no numeric)",
      "protocol_name (string - no numeric)",
      "flow_start_time (timestamp - converted to duration)",
      "flow_duration (converted to microseconds)"
    ]
  },
  
  "features": [
    {
      "model_index": 0,
      "protobuf_field": "source_port",
      "protobuf_field_number": 3,
      "cic_dataset_name": "Source Port",
      "data_type": "uint32",
      "description": "Source port number",
      "typical_range": "0-65535"
    },
    {
      "model_index": 1,
      "protobuf_field": "destination_port",
      "protobuf_field_number": 4,
      "cic_dataset_name": "Destination Port",
      "data_type": "uint32",
      "description": "Destination port number",
      "typical_range": "0-65535"
    },
    {
      "model_index": 2,
      "protobuf_field": "protocol_number",
      "protobuf_field_number": 5,
      "cic_dataset_name": "Protocol",
      "data_type": "uint32",
      "description": "Protocol number (6=TCP, 17=UDP, 1=ICMP)",
      "typical_range": "0-255"
    },
    {
      "model_index": 3,
      "protobuf_field": "flow_duration_microseconds",
      "protobuf_field_number": 9,
      "cic_dataset_name": "Flow Duration",
      "data_type": "uint64",
      "description": "Duration of the flow in microseconds",
      "typical_range": "0-billions"
    },
    {
      "model_index": 4,
      "protobuf_field": "total_forward_packets",
      "protobuf_field_number": 10,
      "cic_dataset_name": "Total Fwd Packet",
      "data_type": "uint64",
      "description": "Total packets in forward direction",
      "typical_range": "0-millions"
    },
    {
      "model_index": 5,
      "protobuf_field": "total_backward_packets",
      "protobuf_field_number": 11,
      "cic_dataset_name": "Total Bwd packets",
      "data_type": "uint64",
      "description": "Total packets in backward direction",
      "typical_range": "0-millions"
    },
    {
      "model_index": 6,
      "protobuf_field": "total_forward_bytes",
      "protobuf_field_number": 12,
      "cic_dataset_name": "Total Length of Fwd Packet",
      "data_type": "uint64",
      "description": "Total bytes in forward direction",
      "typical_range": "0-billions"
    },
    {
      "model_index": 7,
      "protobuf_field": "total_backward_bytes",
      "protobuf_field_number": 13,
      "cic_dataset_name": "Total Length of Bwd Packet",
      "data_type": "uint64",
      "description": "Total bytes in backward direction",
      "typical_range": "0-billions"
    },
    {
      "model_index": 8,
      "protobuf_field": "forward_packet_length_max",
      "protobuf_field_number": 20,
      "cic_dataset_name": "Fwd Packet Length Max",
      "data_type": "uint64",
      "description": "Maximum packet length in forward direction",
      "typical_range": "0-65535"
    },
    {
      "model_index": 9,
      "protobuf_field": "forward_packet_length_min",
      "protobuf_field_number": 21,
      "cic_dataset_name": "Fwd Packet Length Min",
      "data_type": "uint64",
      "description": "Minimum packet length in forward direction",
      "typical_range": "0-65535"
    },
    {
      "model_index": 10,
      "protobuf_field": "forward_packet_length_mean",
      "protobuf_field_number": 22,
      "cic_dataset_name": "Fwd Packet Length Mean",
      "data_type": "double",
      "description": "Mean packet length in forward direction",
      "typical_range": "0-1500"
    },
    {
      "model_index": 11,
      "protobuf_field": "forward_packet_length_std",
      "protobuf_field_number": 23,
      "cic_dataset_name": "Fwd Packet Length Std",
      "data_type": "double",
      "description": "Standard deviation of packet length in forward direction",
      "typical_range": "0-1000"
    },
    {
      "model_index": 12,
      "protobuf_field": "backward_packet_length_max",
      "protobuf_field_number": 30,
      "cic_dataset_name": "Bwd Packet Length Max",
      "data_type": "uint64",
      "description": "Maximum packet length in backward direction",
      "typical_range": "0-65535"
    },
    {
      "model_index": 13,
      "protobuf_field": "backward_packet_length_min",
      "protobuf_field_number": 31,
      "cic_dataset_name": "Bwd Packet Length Min",
      "data_type": "uint64",
      "description": "Minimum packet length in backward direction",
      "typical_range": "0-65535"
    },
    {
      "model_index": 14,
      "protobuf_field": "backward_packet_length_mean",
      "protobuf_field_number": 32,
      "cic_dataset_name": "Bwd Packet Length Mean",
      "data_type": "double",
      "description": "Mean packet length in backward direction",
      "typical_range": "0-1500"
    },
    {
      "model_index": 15,
      "protobuf_field": "backward_packet_length_std",
      "protobuf_field_number": 33,
      "cic_dataset_name": "Bwd Packet Length Std",
      "data_type": "double",
      "description": "Standard deviation of packet length in backward direction",
      "typical_range": "0-1000"
    },
    {
      "model_index": 16,
      "protobuf_field": "flow_bytes_per_second",
      "protobuf_field_number": 40,
      "cic_dataset_name": "Flow Bytes/s",
      "data_type": "double",
      "description": "Flow byte rate per second",
      "typical_range": "0-billions",
      "importance": "high"
    },
    {
      "model_index": 17,
      "protobuf_field": "flow_packets_per_second",
      "protobuf_field_number": 41,
      "cic_dataset_name": "Flow Packets/s",
      "data_type": "double",
      "description": "Flow packet rate per second",
      "typical_range": "0-millions",
      "importance": "high"
    },
    {
      "model_index": 18,
      "protobuf_field": "forward_packets_per_second",
      "protobuf_field_number": 42,
      "cic_dataset_name": "Flow IAT Mean",
      "data_type": "double",
      "description": "Forward packets per second",
      "typical_range": "0-millions"
    },
    {
      "model_index": 19,
      "protobuf_field": "backward_packets_per_second",
      "protobuf_field_number": 43,
      "cic_dataset_name": "Bwd Packets/s",
      "data_type": "double",
      "description": "Backward packets per second",
      "typical_range": "0-millions"
    },
    {
      "model_index": 20,
      "protobuf_field": "download_upload_ratio",
      "protobuf_field_number": 44,
      "cic_dataset_name": "Down/Up Ratio",
      "data_type": "double",
      "description": "Ratio of download to upload traffic",
      "typical_range": "0-100"
    },
    {
      "model_index": 21,
      "protobuf_field": "average_packet_size",
      "protobuf_field_number": 45,
      "cic_dataset_name": "Average Packet Size",
      "data_type": "double",
      "description": "Average packet size in bytes",
      "typical_range": "0-1500"
    },
    {
      "model_index": 22,
      "protobuf_field": "average_forward_segment_size",
      "protobuf_field_number": 46,
      "cic_dataset_name": "Fwd Segment Size Avg",
      "data_type": "double",
      "description": "Average forward segment size",
      "typical_range": "0-1500"
    },
    {
      "model_index": 23,
      "protobuf_field": "average_backward_segment_size",
      "protobuf_field_number": 47,
      "cic_dataset_name": "Bwd Segment Size Avg",
      "data_type": "double",
      "description": "Average backward segment size",
      "typical_range": "0-1500"
    },
    {
      "model_index": 24,
      "protobuf_field": "flow_inter_arrival_time_mean",
      "protobuf_field_number": 50,
      "cic_dataset_name": "Flow IAT Mean",
      "data_type": "double",
      "description": "Mean inter-arrival time of flow packets",
      "typical_range": "0-millions"
    },
    {
      "model_index": 25,
      "protobuf_field": "flow_inter_arrival_time_std",
      "protobuf_field_number": 51,
      "cic_dataset_name": "Flow IAT Std",
      "data_type": "double",
      "description": "Standard deviation of inter-arrival time",
      "typical_range": "0-millions"
    },
    {
      "model_index": 26,
      "protobuf_field": "flow_inter_arrival_time_max",
      "protobuf_field_number": 52,
      "cic_dataset_name": "Flow IAT Max",
      "data_type": "uint64",
      "description": "Maximum inter-arrival time",
      "typical_range": "0-billions"
    },
    {
      "model_index": 27,
      "protobuf_field": "flow_inter_arrival_time_min",
      "protobuf_field_number": 53,
      "cic_dataset_name": "Flow IAT Min",
      "data_type": "uint64",
      "description": "Minimum inter-arrival time",
      "typical_range": "0-billions"
    },
    {
      "model_index": 28,
      "protobuf_field": "forward_inter_arrival_time_total",
      "protobuf_field_number": 54,
      "cic_dataset_name": "Fwd IAT Total",
      "data_type": "double",
      "description": "Total forward inter-arrival time",
      "typical_range": "0-billions"
    },
    {
      "model_index": 29,
      "protobuf_field": "forward_inter_arrival_time_mean",
      "protobuf_field_number": 55,
      "cic_dataset_name": "Fwd IAT Mean",
      "data_type": "double",
      "description": "Mean forward inter-arrival time",
      "typical_range": "0-millions",
      "importance": "medium"
    },
    {
      "model_index": 30,
      "protobuf_field": "forward_inter_arrival_time_std",
      "protobuf_field_number": 56,
      "cic_dataset_name": "Fwd IAT Std",
      "data_type": "double",
      "description": "Std dev forward inter-arrival time",
      "typical_range": "0-millions"
    },
    {
      "model_index": 31,
      "protobuf_field": "forward_inter_arrival_time_max",
      "protobuf_field_number": 57,
      "cic_dataset_name": "Fwd IAT Max",
      "data_type": "uint64",
      "description": "Max forward inter-arrival time",
      "typical_range": "0-billions"
    },
    {
      "model_index": 32,
      "protobuf_field": "forward_inter_arrival_time_min",
      "protobuf_field_number": 58,
      "cic_dataset_name": "Fwd IAT Min",
      "data_type": "uint64",
      "description": "Min forward inter-arrival time",
      "typical_range": "0-billions"
    },
    {
      "model_index": 33,
      "protobuf_field": "backward_inter_arrival_time_total",
      "protobuf_field_number": 59,
      "cic_dataset_name": "Bwd IAT Total",
      "data_type": "double",
      "description": "Total backward inter-arrival time",
      "typical_range": "0-billions"
    },
    {
      "model_index": 34,
      "protobuf_field": "backward_inter_arrival_time_mean",
      "protobuf_field_number": 60,
      "cic_dataset_name": "Bwd IAT Mean",
      "data_type": "double",
      "description": "Mean backward inter-arrival time",
      "typical_range": "0-millions"
    },
    {
      "model_index": 35,
      "protobuf_field": "backward_inter_arrival_time_std",
      "protobuf_field_number": 61,
      "cic_dataset_name": "Bwd IAT Std",
      "data_type": "double",
      "description": "Std dev backward inter-arrival time",
      "typical_range": "0-millions"
    },
    {
      "model_index": 36,
      "protobuf_field": "backward_inter_arrival_time_max",
      "protobuf_field_number": 62,
      "cic_dataset_name": "Bwd IAT Max",
      "data_type": "uint64",
      "description": "Max backward inter-arrival time",
      "typical_range": "0-billions"
    },
    {
      "model_index": 37,
      "protobuf_field": "backward_inter_arrival_time_min",
      "protobuf_field_number": 63,
      "cic_dataset_name": "Bwd IAT Min",
      "data_type": "uint64",
      "description": "Min backward inter-arrival time",
      "typical_range": "0-billions"
    },
    {
      "model_index": 38,
      "protobuf_field": "fin_flag_count",
      "protobuf_field_number": 70,
      "cic_dataset_name": "FIN Flag Count",
      "data_type": "uint32",
      "description": "Number of FIN flags",
      "typical_range": "0-100",
      "importance": "high"
    },
    {
      "model_index": 39,
      "protobuf_field": "syn_flag_count",
      "protobuf_field_number": 71,
      "cic_dataset_name": "SYN Flag Count",
      "data_type": "uint32",
      "description": "Number of SYN flags (critical for SYN flood)",
      "typical_range": "0-100",
      "importance": "critical"
    },
    {
      "model_index": 40,
      "protobuf_field": "rst_flag_count",
      "protobuf_field_number": 72,
      "cic_dataset_name": "RST Flag Count",
      "data_type": "uint32",
      "description": "Number of RST flags",
      "typical_range": "0-100",
      "importance": "high"
    },
    {
      "model_index": 41,
      "protobuf_field": "psh_flag_count",
      "protobuf_field_number": 73,
      "cic_dataset_name": "PSH Flag Count",
      "data_type": "uint32",
      "description": "Number of PSH flags",
      "typical_range": "0-100"
    },
    {
      "model_index": 42,
      "protobuf_field": "ack_flag_count",
      "protobuf_field_number": 74,
      "cic_dataset_name": "ACK Flag Count",
      "data_type": "uint32",
      "description": "Number of ACK flags",
      "typical_range": "0-1000"
    },
    {
      "model_index": 43,
      "protobuf_field": "urg_flag_count",
      "protobuf_field_number": 75,
      "cic_dataset_name": "URG Flag Count",
      "data_type": "uint32",
      "description": "Number of URG flags",
      "typical_range": "0-10"
    },
    {
      "model_index": 44,
      "protobuf_field": "cwe_flag_count",
      "protobuf_field_number": 76,
      "cic_dataset_name": "CWE Flag Count",
      "data_type": "uint32",
      "description": "Number of CWE flags",
      "typical_range": "0-10"
    },
    {
      "model_index": 45,
      "protobuf_field": "ece_flag_count",
      "protobuf_field_number": 77,
      "cic_dataset_name": "ECE Flag Count",
      "data_type": "uint32",
      "description": "Number of ECE flags",
      "typical_range": "0-10"
    },
    {
      "model_index": 46,
      "protobuf_field": "forward_psh_flags",
      "protobuf_field_number": 78,
      "cic_dataset_name": "Fwd PSH Flags",
      "data_type": "uint32",
      "description": "PSH flags in forward direction",
      "typical_range": "0-50"
    },
    {
      "model_index": 47,
      "protobuf_field": "backward_psh_flags",
      "protobuf_field_number": 79,
      "cic_dataset_name": "Bwd PSH Flags",
      "data_type": "uint32",
      "description": "PSH flags in backward direction",
      "typical_range": "0-50"
    },
    {
      "model_index": 48,
      "protobuf_field": "forward_urg_flags",
      "protobuf_field_number": 80,
      "cic_dataset_name": "Fwd URG Flags",
      "data_type": "uint32",
      "description": "URG flags in forward direction",
      "typical_range": "0-10"
    },
    {
      "model_index": 49,
      "protobuf_field": "backward_urg_flags",
      "protobuf_field_number": 81,
      "cic_dataset_name": "Bwd URG Flags",
      "data_type": "uint32",
      "description": "URG flags in backward direction",
      "typical_range": "0-10"
    },
    {
      "model_index": 50,
      "protobuf_field": "forward_header_length",
      "protobuf_field_number": 85,
      "cic_dataset_name": "Fwd Header Length",
      "data_type": "double",
      "description": "Forward header length in bytes",
      "typical_range": "20-60"
    },
    {
      "model_index": 51,
      "protobuf_field": "backward_header_length",
      "protobuf_field_number": 86,
      "cic_dataset_name": "Bwd Header Length",
      "data_type": "double",
      "description": "Backward header length in bytes",
      "typical_range": "20-60"
    },
    {
      "model_index": 52,
      "protobuf_field": "forward_average_bytes_bulk",
      "protobuf_field_number": 87,
      "cic_dataset_name": "Fwd Avg Bytes/Bulk",
      "data_type": "double",
      "description": "Average bytes per bulk in forward direction",
      "typical_range": "0-10000"
    },
    {
      "model_index": 53,
      "protobuf_field": "forward_average_packets_bulk",
      "protobuf_field_number": 88,
      "cic_dataset_name": "Fwd Avg Packets/Bulk",
      "data_type": "double",
      "description": "Average packets per bulk in forward direction",
      "typical_range": "0-1000"
    },
    {
      "model_index": 54,
      "protobuf_field": "forward_average_bulk_rate",
      "protobuf_field_number": 89,
      "cic_dataset_name": "Fwd Avg Bulk Rate",
      "data_type": "double",
      "description": "Average bulk rate in forward direction",
      "typical_range": "0-millions"
    },
    {
      "model_index": 55,
      "protobuf_field": "backward_average_bytes_bulk",
      "protobuf_field_number": 90,
      "cic_dataset_name": "Bwd Avg Bytes/Bulk",
      "data_type": "double",
      "description": "Average bytes per bulk in backward direction",
      "typical_range": "0-10000"
    },
    {
      "model_index": 56,
      "protobuf_field": "backward_average_packets_bulk",
      "protobuf_field_number": 91,
      "cic_dataset_name": "Bwd Avg Packets/Bulk",
      "data_type": "double",
      "description": "Average packets per bulk in backward direction",
      "typical_range": "0-1000"
    },
    {
      "model_index": 57,
      "protobuf_field": "backward_average_bulk_rate",
      "protobuf_field_number": 92,
      "cic_dataset_name": "Bwd Avg Bulk Rate",
      "data_type": "double",
      "description": "Average bulk rate in backward direction",
      "typical_range": "0-millions"
    },
    {
      "model_index": 58,
      "protobuf_field": "minimum_packet_length",
      "protobuf_field_number": 95,
      "cic_dataset_name": "Min Packet Length",
      "data_type": "uint64",
      "description": "Minimum packet length in flow",
      "typical_range": "0-1500"
    },
    {
      "model_index": 59,
      "protobuf_field": "maximum_packet_length",
      "protobuf_field_number": 96,
      "cic_dataset_name": "Max Packet Length",
      "data_type": "uint64",
      "description": "Maximum packet length in flow",
      "typical_range": "0-65535"
    },
    {
      "model_index": 60,
      "protobuf_field": "packet_length_mean",
      "protobuf_field_number": 97,
      "cic_dataset_name": "Packet Length Mean",
      "data_type": "double",
      "description": "Mean packet length",
      "typical_range": "0-1500"
    },
    {
      "model_index": 61,
      "protobuf_field": "packet_length_std",
      "protobuf_field_number": 98,
      "cic_dataset_name": "Packet Length Std",
      "data_type": "double",
      "description": "Standard deviation of packet length",
      "typical_range": "0-1000"
    },
    {
      "model_index": 62,
      "protobuf_field": "packet_length_variance",
      "protobuf_field_number": 99,
      "cic_dataset_name": "Packet Length Variance",
      "data_type": "double",
      "description": "Variance of packet length",
      "typical_range": "0-1000000"
    }
  ],
  
  "integration_guide": {
    "cpp_extraction": [
      "// C++ code to extract features from NetworkFeatures message",
      "std::vector<float> extract_level2_features(const protobuf::NetworkFeatures& nf) {",
      "  std::vector<float> features(70);  // Adjust based on actual count",
      "  ",
      "  // Basic flow identifiers",
      "  features[0] = static_cast<float>(nf.source_port());",
      "  features[1] = static_cast<float>(nf.destination_port());",
      "  features[2] = static_cast<float>(nf.protocol_number());",
      "  ",
      "  // Timing",
      "  features[3] = static_cast<float>(nf.flow_duration_microseconds());",
      "  ",
      "  // Packet counts",
      "  features[4] = static_cast<float>(nf.total_forward_packets());",
      "  features[5] = static_cast<float>(nf.total_backward_packets());",
      "  ",
      "  // Byte counts",
      "  features[6] = static_cast<float>(nf.total_forward_bytes());",
      "  features[7] = static_cast<float>(nf.total_backward_bytes());",
      "  ",
      "  // Continue for all 70 features...",
      "  // See full mapping in features array above",
      "  ",
      "  return features;",
      "}"
    ],
    "notes": [
      "Always cast to float for ONNX compatibility",
      "Handle missing/null values by setting to 0.0f",
      "Maintain exact order as specified in model_index",
      "Normalize/scale if training used normalization (check metadata)"
    ]
  },
  
  "model_performance": {
    "expected_metrics": {
      "accuracy": ">0.98",
      "precision": ">0.97",
      "recall": ">0.96",
      "f1_score": ">0.97",
      "roc_auc": ">0.99"
    },
    "inference_time": {
      "target": "<5ms",
      "typical": "1-3ms",
      "hardware": "CPU (no GPU required)"
    }
  },
  
  "dataset_info": {
    "name": "CIC-DDoS-2019",
    "source": "Canadian Institute for Cybersecurity",
    "ddos_types_included": [
      "SYN Flood",
      "UDP Flood",
      "HTTP Flood",
      "DNS Amplification",
      "LDAP Amplification",
      "MSSQL Amplification",
      "NetBIOS Amplification",
      "NTP Amplification",
      "SNMP Amplification",
      "SSDP Amplification",
      "UDPLag",
      "WebDDoS"
    ],
    "total_samples": "~50M flows",
    "benign_percentage": "~20%",
    "attack_percentage": "~80%"
  }
}
