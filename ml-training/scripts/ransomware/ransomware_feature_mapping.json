{
  "model_name": "level2_ransomware_detector",
  "model_type": "XGBoost Binary Classifier",
  "level": 2,
  "purpose": "Binary Ransomware Detection (BENIGN vs RANSOMWARE/BOT)",
  "version": "2.0.0",
  "created_date": "2025-11-04",
  "target_hardware": "Raspberry Pi 5 (Edge Computing)",
  "target_metrics": {
    "accuracy": ">0.99",
    "f1_score": ">0.99",
    "inference_time": "<10ms",
    "model_size": "<50MB"
  },
  
  "feature_mapping": {
    "description": "Mapeo entre RansomwareFeatures (protobuf) y CIC dataset features",
    "total_features_in_model": 28,
    "ransomware_specific_features": 20,
    "network_base_features": 8,
    "note": "Features optimizadas para detecciÃ³n en edge (Raspberry Pi 5)"
  },
  
  "features": [
    {
      "model_index": 0,
      "category": "C&C Communication",
      "protobuf_field": "dns_query_entropy",
      "protobuf_field_number": 1,
      "cic_dataset_approximation": "Flow IAT Std",
      "description": "DNS query entropy for DGA detection",
      "importance": "critical",
      "typical_range": "0.0-8.0",
      "ransomware_behavior": "High entropy indicates DGA (Domain Generation Algorithm)"
    },
    {
      "model_index": 1,
      "category": "C&C Communication",
      "protobuf_field": "new_external_ips_30s",
      "protobuf_field_number": 2,
      "cic_dataset_approximation": "Flow Pkts/s",
      "description": "New external IPs contacted in 30s window",
      "importance": "high",
      "typical_range": "0-100",
      "ransomware_behavior": "Rapid C&C server discovery attempts"
    },
    {
      "model_index": 2,
      "category": "C&C Communication",
      "protobuf_field": "dns_query_rate_per_min",
      "protobuf_field_number": 3,
      "cic_dataset_approximation": "Flow Pkts/s",
      "description": "DNS queries per minute rate",
      "importance": "high",
      "typical_range": "0-1000",
      "ransomware_behavior": "High rate during C&C contact phase"
    },
    {
      "model_index": 3,
      "category": "C&C Communication",
      "protobuf_field": "failed_dns_queries_ratio",
      "protobuf_field_number": 4,
      "cic_dataset_approximation": "RST Flag Cnt",
      "description": "Ratio of failed DNS queries",
      "importance": "medium",
      "typical_range": "0.0-1.0",
      "ransomware_behavior": "DGA domains often fail to resolve"
    },
    {
      "model_index": 4,
      "category": "Lateral Movement",
      "protobuf_field": "smb_connection_diversity",
      "protobuf_field_number": 7,
      "cic_dataset_approximation": "Dst Port",
      "description": "Diversity of SMB connections (port 445)",
      "importance": "critical",
      "typical_range": "0-50",
      "ransomware_behavior": "Scanning for file shares to encrypt"
    },
    {
      "model_index": 5,
      "category": "Lateral Movement",
      "protobuf_field": "new_internal_connections_30s",
      "protobuf_field_number": 9,
      "cic_dataset_approximation": "Flow Pkts/s",
      "description": "New internal connections in 30s",
      "importance": "high",
      "typical_range": "0-100",
      "ransomware_behavior": "Rapid lateral movement scanning"
    },
    {
      "model_index": 6,
      "category": "Lateral Movement",
      "protobuf_field": "port_scan_pattern_score",
      "protobuf_field_number": 10,
      "cic_dataset_approximation": "SYN Flag Cnt",
      "description": "Port scanning behavior score",
      "importance": "high",
      "typical_range": "0.0-1.0",
      "ransomware_behavior": "Sequential port scanning for vulnerable services"
    },
    {
      "model_index": 7,
      "category": "Exfiltration",
      "protobuf_field": "upload_download_ratio_30s",
      "protobuf_field_number": 11,
      "cic_dataset_approximation": "Down/Up Ratio",
      "description": "Upload/Download ratio in 30s window",
      "importance": "critical",
      "typical_range": "0.0-100.0",
      "ransomware_behavior": "High upload during data exfiltration"
    },
    {
      "model_index": 8,
      "category": "Exfiltration",
      "protobuf_field": "burst_connections_count",
      "protobuf_field_number": 12,
      "cic_dataset_approximation": "Flow Pkts/s",
      "description": "Burst connection patterns",
      "importance": "high",
      "typical_range": "0-1000",
      "ransomware_behavior": "Burst uploads to exfiltrate encrypted files"
    },
    {
      "model_index": 9,
      "category": "Exfiltration",
      "protobuf_field": "unique_destinations_30s",
      "protobuf_field_number": 13,
      "cic_dataset_approximation": "Flow Duration",
      "description": "Unique destination IPs in 30s",
      "importance": "medium",
      "typical_range": "0-50",
      "ransomware_behavior": "Multiple C&C servers or exfiltration targets"
    },
    {
      "model_index": 10,
      "category": "Exfiltration",
      "protobuf_field": "large_upload_sessions_count",
      "protobuf_field_number": 14,
      "cic_dataset_approximation": "TotLen Fwd Pkts",
      "description": "Count of large upload sessions",
      "importance": "high",
      "typical_range": "0-100",
      "ransomware_behavior": "Large files being uploaded after encryption"
    },
    {
      "model_index": 11,
      "category": "Behavioral",
      "protobuf_field": "nocturnal_activity_flag",
      "protobuf_field_number": 15,
      "cic_dataset_approximation": "Timestamp",
      "description": "Activity during non-business hours",
      "importance": "medium",
      "typical_range": "0-1",
      "ransomware_behavior": "Often executes during off-hours"
    },
    {
      "model_index": 12,
      "category": "Behavioral",
      "protobuf_field": "connection_rate_stddev",
      "protobuf_field_number": 16,
      "cic_dataset_approximation": "Flow IAT Std",
      "description": "Standard deviation of connection rate",
      "importance": "high",
      "typical_range": "0-10000",
      "ransomware_behavior": "Irregular connection patterns vs normal"
    },
    {
      "model_index": 13,
      "category": "Behavioral",
      "protobuf_field": "protocol_diversity_score",
      "protobuf_field_number": 17,
      "cic_dataset_approximation": "Protocol",
      "description": "Diversity of protocols used",
      "importance": "medium",
      "typical_range": "0.0-1.0",
      "ransomware_behavior": "Multiple protocols for evasion"
    },
    {
      "model_index": 14,
      "category": "Behavioral",
      "protobuf_field": "avg_flow_duration_seconds",
      "protobuf_field_number": 18,
      "cic_dataset_approximation": "Flow Duration",
      "description": "Average flow duration in seconds",
      "importance": "medium",
      "typical_range": "0-3600",
      "ransomware_behavior": "Short bursts vs sustained legitimate connections"
    },
    {
      "model_index": 15,
      "category": "Behavioral",
      "protobuf_field": "tcp_rst_ratio",
      "protobuf_field_number": 19,
      "cic_dataset_approximation": "RST Flag Cnt",
      "description": "Ratio of TCP RST flags",
      "importance": "high",
      "typical_range": "0.0-1.0",
      "ransomware_behavior": "High RST during scanning/failed connections"
    },
    {
      "model_index": 16,
      "category": "Behavioral",
      "protobuf_field": "syn_without_ack_ratio",
      "protobuf_field_number": 20,
      "cic_dataset_approximation": "SYN Flag Cnt",
      "description": "SYN packets without corresponding ACK",
      "importance": "high",
      "typical_range": "0.0-1.0",
      "ransomware_behavior": "Port scanning signature"
    },
    {
      "model_index": 17,
      "category": "Network Base",
      "protobuf_field": "flow_bytes_per_second",
      "cic_dataset_name": "Flow Byts/s",
      "description": "Flow byte rate",
      "importance": "high"
    },
    {
      "model_index": 18,
      "category": "Network Base",
      "protobuf_field": "flow_packets_per_second",
      "cic_dataset_name": "Flow Pkts/s",
      "description": "Flow packet rate",
      "importance": "high"
    },
    {
      "model_index": 19,
      "category": "Network Base",
      "protobuf_field": "total_forward_packets",
      "cic_dataset_name": "Tot Fwd Pkts",
      "description": "Total forward packets",
      "importance": "medium"
    },
    {
      "model_index": 20,
      "category": "Network Base",
      "protobuf_field": "total_backward_packets",
      "cic_dataset_name": "Tot Bwd Pkts",
      "description": "Total backward packets",
      "importance": "medium"
    },
    {
      "model_index": 21,
      "category": "Network Base",
      "protobuf_field": "packet_length_mean",
      "cic_dataset_name": "Pkt Len Mean",
      "description": "Mean packet length",
      "importance": "medium"
    },
    {
      "model_index": 22,
      "category": "Network Base",
      "protobuf_field": "packet_length_std",
      "cic_dataset_name": "Pkt Len Std",
      "description": "Std dev of packet length",
      "importance": "medium"
    },
    {
      "model_index": 23,
      "category": "Network Base",
      "protobuf_field": "syn_flag_count",
      "cic_dataset_name": "SYN Flag Cnt",
      "description": "SYN flag count",
      "importance": "high"
    },
    {
      "model_index": 24,
      "category": "Network Base",
      "protobuf_field": "rst_flag_count",
      "cic_dataset_name": "RST Flag Cnt",
      "description": "RST flag count",
      "importance": "high"
    },
    {
      "model_index": 25,
      "category": "Network Base",
      "protobuf_field": "psh_flag_count",
      "cic_dataset_name": "PSH Flag Cnt",
      "description": "PSH flag count",
      "importance": "medium"
    },
    {
      "model_index": 26,
      "category": "Network Base",
      "protobuf_field": "ack_flag_count",
      "cic_dataset_name": "ACK Flag Cnt",
      "description": "ACK flag count",
      "importance": "medium"
    },
    {
      "model_index": 27,
      "category": "Network Base",
      "protobuf_field": "destination_port",
      "cic_dataset_name": "Dst Port",
      "description": "Destination port",
      "importance": "high"
    }
  ],
  
  "dataset_info": {
    "training_sources": [
      {
        "name": "CIC-IDS-2018",
        "file": "02-28-2018.csv",
        "attack_label": "Infilteration",
        "attack_samples": 68871,
        "benign_samples": 544200,
        "description": "Infiltration attacks including ransomware-like behavior"
      },
      {
        "name": "CIC-IDS-2017",
        "files": "MachineLearningCVE/*.csv",
        "attack_label": "Bot",
        "attack_samples": 1966,
        "benign_samples": 2270000,
        "description": "Botnet traffic with C&C behavior similar to ransomware"
      }
    ],
    "total_attack_samples": 70837,
    "total_benign_samples": 2814200,
    "balancing_strategy": "SMOTE oversampling for attack class"
  },
  
  "integration_guide": {
    "cpp_extraction": [
      "// Extract features from RansomwareFeatures protobuf message",
      "std::vector<float> extract_ransomware_features(const protobuf::RansomwareFeatures& rf, const protobuf::NetworkFeatures& nf) {",
      "  std::vector<float> features(28);",
      "  ",
      "  // RansomwareFeatures (20 features)",
      "  features[0] = rf.dns_query_entropy();",
      "  features[1] = static_cast<float>(rf.new_external_ips_30s());",
      "  features[2] = rf.dns_query_rate_per_min();",
      "  features[3] = rf.failed_dns_queries_ratio();",
      "  features[4] = static_cast<float>(rf.smb_connection_diversity());",
      "  features[5] = static_cast<float>(rf.new_internal_connections_30s());",
      "  features[6] = rf.port_scan_pattern_score();",
      "  features[7] = rf.upload_download_ratio_30s();",
      "  features[8] = static_cast<float>(rf.burst_connections_count());",
      "  features[9] = static_cast<float>(rf.unique_destinations_30s());",
      "  features[10] = static_cast<float>(rf.large_upload_sessions_count());",
      "  features[11] = rf.nocturnal_activity_flag() ? 1.0f : 0.0f;",
      "  features[12] = rf.connection_rate_stddev();",
      "  features[13] = rf.protocol_diversity_score();",
      "  features[14] = rf.avg_flow_duration_seconds();",
      "  features[15] = rf.tcp_rst_ratio();",
      "  features[16] = rf.syn_without_ack_ratio();",
      "  ",
      "  // NetworkFeatures base (8 features)",
      "  features[17] = static_cast<float>(nf.flow_bytes_per_second());",
      "  features[18] = static_cast<float>(nf.flow_packets_per_second());",
      "  features[19] = static_cast<float>(nf.total_forward_packets());",
      "  features[20] = static_cast<float>(nf.total_backward_packets());",
      "  features[21] = static_cast<float>(nf.packet_length_mean());",
      "  features[22] = static_cast<float>(nf.packet_length_std());",
      "  features[23] = static_cast<float>(nf.syn_flag_count());",
      "  features[24] = static_cast<float>(nf.rst_flag_count());",
      "  features[25] = static_cast<float>(nf.psh_flag_count());",
      "  features[26] = static_cast<float>(nf.ack_flag_count());",
      "  features[27] = static_cast<float>(nf.destination_port());",
      "  ",
      "  return features;",
      "}"
    ]
  }
}
