{
  "_header": "C++20 SNIFFER v3.2 - Production Config with Hybrid Filters (REFACTORED)",
  "_refactor_notes": {
    "date": "2025-10-28",
    "changes": [
      "Removed duplicate 'capture.interface' (redundant with profile.capture_interface)",
      "Removed unused 'capture.kernel_interface' (not implemented)",
      "Removed unused 'capture.user_interface' (not implemented)",
      "Removed legacy root-level 'interface' field",
      "Interface now defined ONLY in profiles.{profile}.capture_interface"
    ]
  },
  "component": {
    "name": "cpp_evolutionary_sniffer",
    "version": "3.2.0",
    "mode": "kernel_user_hybrid",
    "kernel_version_required": "6.12.0"
  },
  "node_id": "cpp_sniffer_v32_001",
  "cluster_name": "upgraded-happiness-cluster",
  "profiles": {
    "lab": {
      "capture_interface": "eth0",
      "promiscuous_mode": true,
      "af_xdp_enabled": true,
      "worker_threads": 2,
      "compression_level": 1
    },
    "cloud": {
      "capture_interface": "eth0",
      "promiscuous_mode": false,
      "af_xdp_enabled": true,
      "worker_threads": 8,
      "compression_level": 3
    },
    "bare_metal": {
      "capture_interface": "eth0",
      "promiscuous_mode": true,
      "af_xdp_enabled": true,
      "worker_threads": 16,
      "compression_level": 1,
      "cpu_affinity_enabled": true
    }
  },
  "profile": "lab",
  "capture": {
    "mode": "ebpf_skb",
    "xdp_flags": [
      "XDP_FLAGS_UPDATE_IF_NOEXIST"
    ],
    "promiscuous_mode": true,

    "_comment_filter": "Hybrid filtering system v3.2 - Dynamic BPF Maps",
    "filter": {
      "version": "1.0",
      "mode": "hybrid",
      "excluded_ports": [22, 4444, 8080],
      "included_ports": [8000],
      "default_action": "capture"
    },

    "buffer_size": 65536,
    "min_packet_size": 20,
    "max_packet_size": 65536,
    "included_protocols": [
      "tcp",
      "udp",
      "icmp"
    ],
    "af_xdp": {
      "enabled": false,
      "queue_id": 0,
      "frame_size": 2048,
      "fill_ring_size": 2048,
      "comp_ring_size": 2048,
      "tx_ring_size": 2048,
      "rx_ring_size": 2048,
      "umem_size": 16777216
    }
  },
  "buffers": {
    "ring_buffer_entries": 65536,
    "user_processing_queue_depth": 300,
    "protobuf_serialize_buffer_size": 65536,
    "zmq_send_buffer_size": 262144,
    "flow_state_buffer_entries": 100000,
    "statistics_buffer_entries": 10000,
    "batch_processing_size": 4
  },
  "threading": {
    "ring_consumer_threads": 1,
    "feature_processor_threads": 1,
    "zmq_sender_threads": 1,
    "statistics_collector_threads": 1,
    "total_worker_threads": 4,
    "cpu_affinity": {
      "enabled": false,
      "ring_consumers": [0, 1],
      "processors": [2, 3, 4, 5],
      "zmq_senders": [6, 7],
      "statistics": [8]
    },
    "thread_priorities": {
      "ring_consumers": "high",
      "processors": "normal",
      "zmq_senders": "normal"
    }
  },
  "kernel_space": {
    "ebpf_program": "sniffer.bpf.o",
    "xdp_mode": "skb",
    "ring_buffer_size": 1048576,
    "max_flows_in_kernel": 100000,
    "flow_timeout_seconds": 300,
    "kernel_features": [
      "source_ip",
      "destination_ip",
      "source_port",
      "destination_port",
      "protocol_number",
      "total_forward_packets",
      "total_backward_packets",
      "total_forward_bytes",
      "total_backward_bytes",
      "fin_flag_count",
      "syn_flag_count",
      "rst_flag_count",
      "psh_flag_count",
      "ack_flag_count",
      "urg_flag_count"
    ],
    "performance": {
      "cpu_budget_us_per_packet": 50,
      "max_instructions_per_program": 1000000,
      "map_update_batch_size": 100
    }
  },
  "user_space": {
    "flow_table_size": 1000000,
    "time_window_buffer_size": 10000,
    "user_features": [
      "ddos_feature_group",
      "ransomware_feature_group",
      "rf_feature_group",
      "internal_traffic_feature_group"
    ],
    "memory_management": {
      "flow_eviction_policy": "lru",
      "max_memory_usage_mb": 2048,
      "gc_interval_seconds": 60
    }
  },
  "feature_groups": {
    "ddos_feature_group": {
      "count": 83,
      "reference": "config/features/ddos_83_features.json",
      "description": "DDOS detection features including packet rates, flag patterns, timing analysis"
    },
    "ransomware_feature_group": {
      "count": 20,
      "reference": "config/features/ransomware_20_features.json",
      "description": "Ransomware detection features (20 critical features optimized for RPi)"
    },
    "rf_feature_group": {
      "count": 23,
      "reference": "config/features/rf_23_features.json",
      "description": "Random Forest general attack detection (Level 1)"
    },
    "internal_traffic_feature_group": {
      "count": 4,
      "reference": "config/features/internal_4_features.json",
      "description": "Internal traffic classification features"
    }
  },
  "sniffer_time_windows": {
    "flow_tracking_window_seconds": 300,
    "statistics_collection_window_seconds": 60,
    "feature_aggregation_window_seconds": 30,
    "cleanup_interval_seconds": 30,
    "max_flows_per_window": 100000,
    "window_overlap_seconds": 10
  },
  "network": {
    "output_socket": {
      "address": "127.0.0.1",
      "port": 5571,
      "mode": "bind",
      "socket_type": "PUSH",
      "high_water_mark": 1000
    }
  },
  "zmq": {
    "worker_threads": 1,
    "io_thread_pools": 1,
    "socket_pools": {
      "push_sockets": 1,
      "load_balancing": "round_robin",
      "failover_enabled": true
    },
    "queue_management": {
      "internal_queues": 2,
      "queue_size": 300,
      "queue_timeout_ms": 100,
      "overflow_policy": "drop_oldest"
    },
    "connection_settings": {
      "sndhwm": 1000,
      "linger_ms": 100,
      "send_timeout_ms": 250,
      "rcvhwm": 1000,
      "recv_timeout_ms": 500,
      "tcp_keepalive": 1,
      "sndbuf": 262144,
      "rcvbuf": 262144,
      "reconnect_interval_ms": 1000,
      "max_reconnect_attempts": 10
    },
    "batch_processing": {
      "enabled": false,
      "batch_size": 50,
      "batch_timeout_ms": 10,
      "max_batches_queued": 100
    }
  },
  "transport": {
    "compression": {
      "enabled": false,
      "algorithm": "lz4",
      "level": 1,
      "min_compress_size": 0,
      "compression_ratio_threshold": 0.8,
      "adaptive_compression": false
    },
    "encryption": {
      "enabled": false,
      "etcd_token_required": true,
      "algorithm": "chacha20-poly1305",
      "key_size": 256,
      "key_rotation_hours": 24,
      "fallback_mode": "compression_only",
      "zmq_curve_enabled": true,
      "curve_server_key": null,
      "curve_secret_key": null
    }
  },
  "etcd": {
    "enabled": false,
    "endpoints": ["localhost:2379"],
    "connection_timeout_ms": 5000,
    "retry_attempts": 3,
    "retry_interval_ms": 1000,
    "crypto_token_path": "/crypto/sniffer/tokens",
    "config_sync_path": "/config/sniffer",
    "required_for_encryption": true,
    "fallback_mode": "standalone_unencrypted",
    "heartbeat_interval_seconds": 30,
    "lease_ttl_seconds": 60
  },
  "processing": {
    "kernel_processing": {
      "max_map_entries": 1000000,
      "flow_hash_table_size": 1000000,
      "counter_map_size": 100000,
      "stats_collection_interval_ms": 1000
    },
    "user_processing": {
      "internal_queue_size": 10000,
      "queue_timeout_seconds": 1,
      "batch_size": 100,
      "lockfree_queues": true,
      "numa_aware_allocation": true,
      "memory_prefaulting": true
    },
    "feature_extraction": {
      "enabled": false,
      "extract_all_features": true,
      "cache_flow_states": true,
      "flow_timeout_seconds": 300,
      "max_concurrent_flows": 1000000,
      "statistics_engine": "high_performance_cpp",
      "simd_optimization": true
    }
  },
  "auto_tuner": {
    "enabled": false,
    "calibration_on_startup": true,
    "benchmark_iterations": 100000,
    "recalibration_interval_hours": 24,
    "safety_margin_factor": 1.2,
    "feature_placement_strategy": "cost_benefit_optimization"
  },
  "monitoring": {
    "stats_interval_seconds": 30,
    "performance_tracking": true,
    "kernel_metrics": {
      "ebpf_program_stats": true,
      "map_utilization": true,
      "instruction_count": true,
      "processing_time_per_packet": true
    },
    "user_metrics": {
      "feature_extraction_rate": true,
      "queue_depth": true,
      "memory_usage": true,
      "thread_utilization": true,
      "compression_ratio": true,
      "zmq_throughput": true
    },
    "alerts": {
      "max_drop_rate_percent": 1,
      "max_queue_usage_percent": 85,
      "max_memory_usage_mb": 4096,
      "max_cpu_usage_percent": 80,
      "max_processing_latency_us": 100,
      "min_compression_ratio": 0.3
    }
  },
  "logging": {
    "level": "INFO",
    "file": "logs/cpp_evolutionary_sniffer_v32.log",
    "max_file_size_mb": 200,
    "backup_count": 10,
    "include_performance_logs": true,
    "include_compression_stats": true,
    "include_thread_stats": true
  },
  "protobuf": {
    "schema_version": "v3.1.0",
    "validate_before_send": true,
    "max_event_size_bytes": 100000,
    "serialization_timeout_ms": 50,
    "pool_size": 1000,
    "reuse_objects": true
  },
  "security": {
    "input_validation": {
      "enabled": false,
      "max_packet_size_bytes": 65536,
      "validate_ip_addresses": true,
      "validate_ports": true,
      "sanitize_inputs": true
    }
  },
  "backpressure": {
    "enabled": false,
    "kernel_backpressure": {
      "ring_buffer_full_action": "drop_oldest"
    },
    "user_backpressure": {
      "max_drops_per_second": 1000,
      "adaptive_rate_limiting": true
    },
    "circuit_breaker": {
      "enabled": false,
      "failure_threshold": 50,
      "recovery_timeout": 30
    }
  }
}